<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>NetHack-inspired ASCII Roguelike</title>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6589496347864618"
     crossorigin="anonymous"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Courier New', monospace;
        }
        
        body {
            background: #0c0c18;
            color: #e6e6e6;
            min-height: 100vh;
            padding: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            overflow-x: hidden;
        }
        
        .ad-banner {
            width: 100%;
            max-width: 800px;
            height: 90px;
            background: linear-gradient(135deg, #1e1e3a, #2d2d4d);
            border: 1px solid #444488;
            border-radius: 8px;
            margin: 10px 0 20px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: #8888cc;
            text-align: center;
            padding: 10px;
        }
        
        .ad-label {
            font-size: 0.9rem;
            color: #a9a9a9;
            margin-bottom: 5px;
            text-transform: uppercase;
        }
        
        header {
            text-align: center;
            margin-bottom: 15px;
            width: 100%;
            max-width: 800px;
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 5px;
            color: #ffd700;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
            letter-spacing: 2px;
        }
        
        .subtitle {
            font-size: 1.1rem;
            color: #a9a9a9;
            margin-bottom: 10px;
        }
        
        .container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
            width: 100%;
            max-width: 1200px;
        }
        
        .game-container {
            flex: 1;
            min-width: 300px;
            max-width: 600px;
            background: #0d0d1a;
            border: 2px solid #333355;
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 0 20px rgba(0, 0, 50, 0.7);
            display: flex;
            flex-direction: column;
        }
        
        .game-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #333355;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .stats {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        .stat {
            background: rgba(40, 40, 80, 0.7);
            padding: 8px 12px;
            border-radius: 5px;
            border: 1px solid #444466;
            font-size: 0.9rem;
        }
        
        .game-map {
            background: #0a0a15;
            border: 1px solid #222244;
            border-radius: 5px;
            padding: 10px;
            margin-bottom: 15px;
            line-height: 1;
            font-size: 16px;
            font-weight: bold;
            letter-spacing: 3px;
            text-align: center;
            min-height: 300px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: default;
            user-select: none;
        }
        
        .controls {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(3, 1fr);
            gap: 8px;
            margin-top: 10px;
        }
        
        .control-btn {
            background: rgba(60, 60, 100, 0.6);
            border: 1px solid #444488;
            border-radius: 8px;
            color: #e6e6e6;
            font-size: 24px;
            padding: 15px 0;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            user-select: none;
        }
        
        .control-btn:active {
            background: rgba(90, 90, 140, 0.8);
            transform: scale(0.95);
        }
        
        .up { grid-column: 2; grid-row: 1; }
        .left { grid-column: 1; grid-row: 2; }
        .down { grid-column: 2; grid-row: 3; }
        .right { grid-column: 3; grid-row: 2; }
        .action { grid-column: 3; grid-row: 3; }
        
        .sidebar {
            flex: 1;
            min-width: 300px;
            max-width: 500px;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .inventory {
            background: rgba(20, 20, 40, 0.8);
            border: 1px solid #333355;
            border-radius: 10px;
            padding: 20px;
        }
        
        .inventory h2 {
            color: #ffd700;
            margin-bottom: 15px;
            font-size: 1.5rem;
            border-bottom: 1px solid #333355;
            padding-bottom: 8px;
        }
        
        .inventory-items {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .item {
            background: rgba(40, 40, 80, 0.7);
            border: 1px solid #444466;
            border-radius: 8px;
            padding: 10px;
            min-width: 120px;
            text-align: center;
            font-size: 0.9rem;
        }
        
        .log {
            background: rgba(20, 20, 40, 0.8);
            border: 1px solid #333355;
            border-radius: 10px;
            padding: 20px;
            min-height: 200px;
        }
        
        .log h2 {
            color: #ffd700;
            margin-bottom: 15px;
            font-size: 1.5rem;
            border-bottom: 1px solid #333355;
            padding-bottom: 8px;
        }
        
        .log-content {
            height: 150px;
            overflow-y: auto;
            font-size: 0.9rem;
            line-height: 1.4;
        }
        
        .log-entry {
            margin-bottom: 5px;
            padding: 3px;
            border-radius: 3px;
        }
        
        .info { color: #add8e6; }
        .damage { color: #ff6347; }
        .heal { color: #7cfc00; }
        .loot { color: #ffd700; }
        .special { color: #ff69b4; }
        
        @media (max-width: 768px) {
            .container {
                flex-direction: column;
                align-items: center;
            }
            
            .game-container, .sidebar {
                width: 100%;
                max-width: 100%;
            }
            
            h1 {
                font-size: 2.0rem;
            }
            
            .game-map {
                min-height: 250px;
                font-size: 14px;
            }
            
            .controls {
                grid-template-columns: repeat(3, 1fr);
                grid-template-rows: auto;
            }
            
            .stat {
                padding: 6px 10px;
                font-size: 0.85rem;
            }
        }
        
        @media (max-width: 480px) {
            .game-map {
                font-size: 12px;
                letter-spacing: 2px;
            }
            
            .control-btn {
                font-size: 20px;
                padding: 12px 0;
            }
            
            h1 {
                font-size: 1.8rem;
            }
            
            .ad-banner {
                height: 80px;
                padding: 8px;
            }
        }
    </style>
</head>
<body>
    <div class="ad-banner">
        <div class="ad-label">Advertisement</div>
        <div>Banner Ad (728 × 90)</div>
        <div>Powered by Google AdSense</div>
    </div>
    
    <header>
        <h1>ASCII DUNGEON</h1>
        <div class="subtitle">A Nethack-inspired Roguelike Adventure</div>
    </header>
    
    <div class="container">
        <div class="game-container">
            <div class="game-header">
                <div class="stats">
                    <div class="stat">Depth: <span id="level">1</span></div>
                    <div class="stat">HP: <span id="hp">30</span>/<span id="max-hp">30</span></div>
                    <div class="stat">Gold: <span id="gold">0</span></div>
                </div>
                <div class="stats">
                    <div class="stat">AC: <span id="ac">5</span></div>
                    <div class="stat">XP: <span id="xp">1</span></div>
                    <div class="stat">STR: <span id="str">16</span></div>
                </div>
            </div>
            
            <div class="game-map" id="map">
                <pre id="map-display"></pre>
            </div>
            
            <div class="controls">
                <div class="control-btn up" id="up">↑</div>
                <div class="control-btn left" id="left">←</div>
                <div class="control-btn down" id="down">↓</div>
                <div class="control-btn right" id="right">→</div>
                <div class="control-btn action" id="action">⛨</div>
            </div>
        </div>
        
        <div class="sidebar">
            <div class="inventory">
                <h2>Inventory</h2>
                <div class="inventory-items">
                    <div class="item">Dagger (weapon)</div>
                    <div class="item">Leather Armor</div>
                    <div class="item">Health Potion (3)</div>
                    <div class="item">Scroll of Identify</div>
                    <div class="item">Food Ration (5)</div>
                    <div class="item">Wand of Magic Missile (3)</div>
                </div>
            </div>
            
            <div class="log">
                <h2>Game Log</h2>
                <div class="log-content" id="log">
                    <div class="log-entry info">Welcome to the Dungeon of Doom!</div>
                    <div class="log-entry info">Use arrow keys or buttons to move.</div>
                    <div class="log-entry loot">You found a health potion!</div>
                    <div class="log-entry damage">Kobold hits you for 4 damage!</div>
                    <div class="log-entry heal">You drank a health potion.</div>
                    <div class="log-entry special">You feel stronger! Strength increased.</div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // Game state
        const gameState = {
            level: 1,
            player: {
                x: 5,
                y: 5,
                hp: 30,
                maxHp: 30,
                ac: 5,
                xp: 1,
                str: 16,
                gold: 0,
                inventory: [
                    "Dagger (weapon)",
                    "Leather Armor",
                    "Health Potion (3)",
                    "Scroll of Identify",
                    "Food Ration (5)",
                    "Wand of Magic Missile (3)"
                ]
            },
            map: [],
            entities: [],
            log: []
        };
        
        // Game symbols (Nethack style)
        const symbols = {
            player: '@',
            wall: '#',
            floor: '.',
            corridor: '#',
            door: '+',
            enemy: [
                'k', // kobold
                'o', // orc
                'z', // zombie
                's', // snake
                'D'  // dragon
            ],
            treasure: [
                '$',
                '*'
            ],
            potion: '!',
            scroll: '?',
            weapon: ')',
            armor: '[',
            food: '%',
            stairs: '>'
        };
        
        // Initialize the game
        function initGame() {
            generateMap();
            spawnEntities();
            updateUI();
        }
        
        // Generate a dungeon map (Nethack style with rooms and corridors)
        function generateMap() {
            const width = 21;
            const height = 15;
            gameState.map = [];
            
            // Create empty map with walls
            for (let y = 0; y < height; y++) {
                const row = [];
                for (let x = 0; x < width; x++) {
                    row.push(symbols.wall);
                }
                gameState.map.push(row);
            }
            
            // Create rooms
            const rooms = [];
            const numRooms = 5 + Math.floor(Math.random() * 3);
            
            for (let i = 0; i < numRooms; i++) {
                const roomWidth = 4 + Math.floor(Math.random() * 5);
                const roomHeight = 3 + Math.floor(Math.random() * 4);
                const x = 1 + Math.floor(Math.random() * (width - roomWidth - 2));
                const y = 1 + Math.floor(Math.random() * (height - roomHeight - 2));
                
                // Check for overlap
                let overlap = false;
                for (const room of rooms) {
                    if (x < room.x + room.width + 1 && 
                        x + roomWidth + 1 > room.x &&
                        y < room.y + room.height + 1 && 
                        y + roomHeight + 1 > room.y) {
                        overlap = true;
                        break;
                    }
                }
                
                if (!overlap) {
                    rooms.push({x, y, width: roomWidth, height: roomHeight});
                    
                    // Carve out room
                    for (let ry = y; ry < y + roomHeight; ry++) {
                        for (let rx = x; rx < x + roomWidth; rx++) {
                            gameState.map[ry][rx] = symbols.floor;
                        }
                    }
                }
            }
            
            // Connect rooms with corridors
            for (let i = 0; i < rooms.length - 1; i++) {
                const room1 = rooms[i];
                const room2 = rooms[i+1];
                
                const startX = Math.floor(room1.x + room1.width/2);
                const startY = Math.floor(room1.y + room1.height/2);
                const endX = Math.floor(room2.x + room2.width/2);
                const endY = Math.floor(room2.y + room2.height/2);
                
                // Horizontal corridor
                for (let x = Math.min(startX, endX); x <= Math.max(startX, endX); x++) {
                    gameState.map[startY][x] = symbols.corridor;
                }
                
                // Vertical corridor
                for (let y = Math.min(startY, endY); y <= Math.max(startY, endY); y++) {
                    gameState.map[y][endX] = symbols.corridor;
                }
            }
            
            // Place player in first room
            gameState.player.x = Math.floor(rooms[0].x + rooms[0].width/2);
            gameState.player.y = Math.floor(rooms[0].y + rooms[0].height/2);
            
            // Ensure player position is walkable
            gameState.map[gameState.player.y][gameState.player.x] = symbols.floor;
        }
        
        // Spawn entities (enemies, items, etc)
        function spawnEntities() {
            gameState.entities = [];
            
            // Spawn enemies
            for (let i = 0; i < 8; i++) {
                const x = Math.floor(Math.random() * 19) + 1;
                const y = Math.floor(Math.random() * 13) + 1;
                
                // Don't spawn on walls or player
                if (gameState.map[y][x] === symbols.floor && 
                    !(x === gameState.player.x && y === gameState.player.y)) {
                    const enemyType = Math.floor(Math.random() * symbols.enemy.length);
                    const enemyStats = [
                        {hp: 8, attack: 4, xp: 10},  // kobold
                        {hp: 12, attack: 6, xp: 20}, // orc
                        {hp: 15, attack: 5, xp: 25}, // zombie
                        {hp: 10, attack: 7, xp: 15}, // snake
                        {hp: 40, attack: 12, xp: 100} // dragon
                    ];
                    
                    gameState.entities.push({
                        type: 'enemy',
                        symbol: symbols.enemy[enemyType],
                        name: ['Kobold', 'Orc', 'Zombie', 'Snake', 'Dragon'][enemyType],
                        x: x,
                        y: y,
                        hp: enemyStats[enemyType].hp,
                        maxHp: enemyStats[enemyType].hp,
                        attack: enemyStats[enemyType].attack,
                        xp: enemyStats[enemyType].xp
                    });
                }
            }
            
            // Spawn treasure
            for (let i = 0; i < 5; i++) {
                const x = Math.floor(Math.random() * 19) + 1;
                const y = Math.floor(Math.random() * 13) + 1;
                
                if (gameState.map[y][x] === symbols.floor && 
                    !gameState.entities.some(e => e.x === x && e.y === y)) {
                    const treasureType = Math.floor(Math.random() * 2);
                    gameState.entities.push({
                        type: 'treasure',
                        symbol: symbols.treasure[treasureType],
                        name: ['Gold coins', 'Gems'][treasureType],
                        x: x,
                        y: y,
                        value: Math.floor(Math.random() * 20) + 10
                    });
                }
            }
            
            // Spawn health potions
            for (let i = 0; i < 3; i++) {
                const x = Math.floor(Math.random() * 19) + 1;
                const y = Math.floor(Math.random() * 13) + 1;
                
                if (gameState.map[y][x] === symbols.floor && 
                    !gameState.entities.some(e => e.x === x && e.y === y)) {
                    gameState.entities.push({
                        type: 'potion',
                        symbol: symbols.potion,
                        name: 'Health Potion',
                        x: x,
                        y: y,
                        heal: 10
                    });
                }
            }
            
            // Add stairs
            let stairsPlaced = false;
            while (!stairsPlaced) {
                const x = Math.floor(Math.random() * 19) + 1;
                const y = Math.floor(Math.random() * 13) + 1;
                
                if (gameState.map[y][x] === symbols.floor && 
                    !gameState.entities.some(e => e.x === x && e.y === y)) {
                    gameState.entities.push({
                        type: 'stairs',
                        symbol: symbols.stairs,
                        name: 'Stairs down',
                        x: x,
                        y: y
                    });
                    stairsPlaced = true;
                }
            }
        }
        
        // Render the map
        function renderMap() {
            let mapDisplay = '';
            
            for (let y = 0; y < gameState.map.length; y++) {
                let row = '';
                for (let x = 0; x < gameState.map[y].length; x++) {
                    // Check if player is here
                    if (x === gameState.player.x && y === gameState.player.y) {
                        row += `<span style="color:#FFD700">${symbols.player}</span>`;
                        continue;
                    }
                    
                    // Check for entities
                    const entity = gameState.entities.find(e => e.x === x && e.y === y);
                    if (entity) {
                        let color = '#FFFFFF';
                        switch (entity.type) {
                            case 'enemy': 
                                color = entity.symbol === 'D' ? '#FF6347' : '#FFA500'; 
                                break;
                            case 'treasure': color = '#FFD700'; break;
                            case 'potion': color = '#7CFC00'; break;
                            case 'stairs': color = '#ADD8E6'; break;
                        }
                        row += `<span style="color:${color}">${entity.symbol}</span>`;
                        continue;
                    }
                    
                    // Map tiles
                    switch (gameState.map[y][x]) {
                        case symbols.wall:
                            row += `<span style="color:#5555AA">${symbols.wall}</span>`;
                            break;
                        case symbols.corridor:
                            row += `<span style="color:#7777CC">${symbols.corridor}</span>`;
                            break;
                        case symbols.door:
                            row += `<span style="color:#AA8855">${symbols.door}</span>`;
                            break;
                        default:
                            row += `<span style="color:#888888">${symbols.floor}</span>`;
                    }
                }
                mapDisplay += row + '\n';
            }
            
            document.getElementById('map-display').innerHTML = mapDisplay;
        }
        
        // Update UI elements
        function updateUI() {
            document.getElementById('level').textContent = gameState.level;
            document.getElementById('hp').textContent = gameState.player.hp;
            document.getElementById('max-hp').textContent = gameState.player.maxHp;
            document.getElementById('gold').textContent = gameState.player.gold;
            document.getElementById('ac').textContent = gameState.player.ac;
            document.getElementById('xp').textContent = gameState.player.xp;
            document.getElementById('str').textContent = gameState.player.str;
            
            renderMap();
        }
        
        // Move player
        function movePlayer(dx, dy) {
            const newX = gameState.player.x + dx;
            const newY = gameState.player.y + dy;
            
            // Check if move is valid
            if (gameState.map[newY] && 
                gameState.map[newY][newX] !== symbols.wall &&
                gameState.map[newY][newX] !== symbols.corridor) {
                
                // Check for entity interaction
                const entityIndex = gameState.entities.findIndex(e => e.x === newX && e.y === newY);
                
                if (entityIndex !== -1) {
                    const entity = gameState.entities[entityIndex];
                    
                    switch (entity.type) {
                        case 'enemy':
                            // Combat
                            const hitRoll = Math.floor(Math.random() * 20) + 1;
                            const hit = hitRoll > 5; // Simple hit chance
                            
                            if (hit) {
                                const playerDamage = Math.max(1, Math.floor(Math.random() * 6) + Math.floor(gameState.player.str/3));
                                entity.hp -= playerDamage;
                                
                                addLog(`You hit ${entity.name} for <span class="damage">${playerDamage} damage</span>`, 'damage');
                                
                                if (entity.hp <= 0) {
                                    // Enemy defeated
                                    gameState.entities.splice(entityIndex, 1);
                                    addLog(`${entity.name} defeated! <span class="loot">+${entity.xp} XP</span>`, 'info');
                                    gameState.player.xp += entity.xp;
                                    
                                    // Drop gold
                                    const goldDrop = Math.floor(Math.random() * 10) + 5;
                                    gameState.player.gold += goldDrop;
                                    addLog(`Found <span class="loot">${goldDrop} gold</span>`, 'loot');
                                    
                                    // Level up
                                    if (gameState.player.xp >= gameState.level * 20) {
                                        gameState.level++;
                                        gameState.player.maxHp += 5;
                                        gameState.player.hp = gameState.player.maxHp;
                                        addLog(`<span class="special">You reached level ${gameState.level}!</span>`, 'special');
                                    }
                                }
                            } else {
                                addLog(`You miss the ${entity.name}!`, 'info');
                            }
                            
                            // Enemy counter-attack
                            const enemyHitRoll = Math.floor(Math.random() * 20) + 1;
                            if (enemyHitRoll > gameState.player.ac) {
                                const enemyDamage = Math.max(1, Math.floor(Math.random() * entity.attack) + 1);
                                gameState.player.hp -= enemyDamage;
                                addLog(`${entity.name} hits you for <span class="damage">${enemyDamage} damage</span>`, 'damage');
                            } else {
                                addLog(`${entity.name} misses you!`, 'info');
                            }
                            break;
                            
                        case 'treasure':
                            gameState.player.gold += entity.value;
                            addLog(`Found ${entity.name}! <span class="loot">+${entity.value} gold</span>`, 'loot');
                            gameState.entities.splice(entityIndex, 1);
                            break;
                            
                        case 'potion':
                            gameState.player.hp = Math.min(gameState.player.maxHp, gameState.player.hp + entity.heal);
                            addLog(`Drank health potion. <span class="heal">+${entity.heal} HP</span>`, 'heal');
                            gameState.entities.splice(entityIndex, 1);
                            break;
                            
                        case 'stairs':
                            gameState.level++;
                            addLog(`Descending to depth <span class="info">${gameState.level}</span>...`, 'info');
                            generateMap();
                            spawnEntities();
                            gameState.player.hp = Math.min(gameState.player.maxHp, gameState.player.hp + 5);
                            break;
                    }
                } else {
                    // Move player
                    gameState.player.x = newX;
                    gameState.player.y = newY;
                    
                    // Random events
                    if (Math.random() < 0.15) {
                        const events = [
                            { text: "You hear footsteps nearby", type: "info" },
                            { text: "A bat flies past your head", type: "info" },
                            { text: "You find some coins in a crevice", type: "loot", gold: Math.floor(Math.random() * 5) + 1 },
                            { text: "You feel a surge of strength", type: "special", effect: "str" }
                        ];
                        
                        const event = events[Math.floor(Math.random() * events.length)];
                        if (event.gold) {
                            gameState.player.gold += event.gold;
                            addLog(`${event.text} <span class="loot">+${event.gold} gold</span>`, event.type);
                        } else if (event.effect === "str") {
                            gameState.player.str += 1;
                            addLog(`${event.text} <span class="special">Strength increased!</span>`, event.type);
                        } else {
                            addLog(event.text, event.type);
                        }
                    }
                }
                
                // Move enemies randomly
                moveEnemies();
                
                // Check if player died
                if (gameState.player.hp <= 0) {
                    gameState.player.hp = 0;
                    addLog(`<span class="damage">You died! Game over.</span>`, 'damage');
                    setTimeout(() => {
                        alert("Game Over! Your adventure ends here...");
                        resetGame();
                    }, 500);
                }
                
                updateUI();
            }
        }
        
        // Move enemies randomly
        function moveEnemies() {
            gameState.entities.forEach(entity => {
                if (entity.type === 'enemy') {
                    // Only move sometimes
                    if (Math.random() < 0.6) {
                        const directions = [
                            {dx: -1, dy: 0},
                            {dx: 1, dy: 0},
                            {dx: 0, dy: -1},
                            {dx: 0, dy: 1}
                        ];
                        
                        const dir = directions[Math.floor(Math.random() * directions.length)];
                        const newX = entity.x + dir.dx;
                        const newY = entity.y + dir.dy;
                        
                        if (gameState.map[newY] && 
                            gameState.map[newY][newX] !== symbols.wall &&
                            gameState.map[newY][newX] !== symbols.corridor &&
                            !gameState.entities.some(e => e.x === newX && e.y === newY)) {
                            entity.x = newX;
                            entity.y = newY;
                        }
                    }
                }
            });
        }
        
        // Add message to game log
        function addLog(message, type) {
            const logElement = document.getElementById('log');
            const entry = document.createElement('div');
            entry.className = `log-entry ${type}`;
            entry.innerHTML = message;
            logElement.prepend(entry);
            
            // Keep log to 8 entries
            if (logElement.children.length > 8) {
                logElement.removeChild(logElement.lastChild);
            }
            
            // Auto-scroll to top
            logElement.scrollTop = 0;
        }
        
        // Reset game
        function resetGame() {
            gameState.level = 1;
            gameState.player = {
                x: 5,
                y: 5,
                hp: 30,
                maxHp: 30,
                ac: 5,
                xp: 1,
                str: 16,
                gold: 0,
                inventory: [
                    "Dagger (weapon)",
                    "Leather Armor",
                    "Health Potion (3)",
                    "Scroll of Identify",
                    "Food Ration (5)",
                    "Wand of Magic Missile (3)"
                ]
            };
            
            document.getElementById('log').innerHTML = `
                <div class="log-entry info">Welcome to the Dungeon of Doom!</div>
                <div class="log-entry info">Use arrow keys or buttons to move.</div>
            `;
            
            generateMap();
            spawnEntities();
            updateUI();
        }
        
        // Set up controls
        function setupControls() {
            // Arrow keys
            document.addEventListener('keydown', (e) => {
                switch(e.key) {
                    case 'ArrowUp': movePlayer(0, -1); break;
                    case 'ArrowDown': movePlayer(0, 1); break;
                    case 'ArrowLeft': movePlayer(-1, 0); break;
                    case 'ArrowRight': movePlayer(1, 0); break;
                    case ' ': 
                    case 'Enter': 
                        // Use item action
                        const item = gameState.player.inventory[Math.floor(Math.random() * 3)];
                        addLog(`You use ${item}`, "info");
                        break;
                }
            });
            
            // Touch controls
            document.getElementById('up').addEventListener('click', () => movePlayer(0, -1));
            document.getElementById('down').addEventListener('click', () => movePlayer(0, 1));
            document.getElementById('left').addEventListener('click', () => movePlayer(-1, 0));
            document.getElementById('right').addEventListener('click', () => movePlayer(1, 0));
            document.getElementById('action').addEventListener('click', () => {
                const item = gameState.player.inventory[Math.floor(Math.random() * 3)];
                addLog(`You use ${item}`, "info");
            });
            
            // Touch swipe support
            let touchStartX = 0;
            let touchStartY = 0;
            
            document.getElementById('map').addEventListener('touchstart', (e) => {
                touchStartX = e.touches[0].clientX;
                touchStartY = e.touches[0].clientY;
                e.preventDefault();
            }, false);
            
            document.getElementById('map').addEventListener('touchmove', (e) => {
                e.preventDefault();
            }, false);
            
            document.getElementById('map').addEventListener('touchend', (e) => {
                const touchEndX = e.changedTouches[0].clientX;
                const touchEndY = e.changedTouches[0].clientY;
                
                const dx = touchEndX - touchStartX;
                const dy = touchEndY - touchStartY;
                
                // Minimum swipe distance
                if (Math.abs(dx) > 20 || Math.abs(dy) > 20) {
                    if (Math.abs(dx) > Math.abs(dy)) {
                        // Horizontal swipe
                        if (dx > 0) movePlayer(1, 0);
                        else movePlayer(-1, 0);
                    } else {
                        // Vertical swipe
                        if (dy > 0) movePlayer(0, 1);
                        else movePlayer(0, -1);
                    }
                }
                e.preventDefault();
            }, false);
        }
        
        // Initialize game when page loads
        window.onload = function() {
            initGame();
            setupControls();
            
            // Initialize AdSense
            (adsbygoogle = window.adsbygoogle || []).push({});
        };
    </script>
</body>
</html>
